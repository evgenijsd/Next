<?xml version="1.0" encoding="utf-8" ?>
<views:BaseContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:views="clr-namespace:Next2.Views"
                       xmlns:controls="clr-namespace:Next2.Controls"
                       xmlns:prism="http://prismlibrary.com"
                       xmlns:xct="http://xamarin.com/schemas/2020/toolkit"
                       xmlns:ffimageloading="clr-namespace:FFImageLoading.Forms;assembly=FFImageLoading.Forms"
                       xmlns:buttons="clr-namespace:Next2.Controls.Buttons"
                       xmlns:models="clr-namespace:Next2.Models"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Next2.Views.Tablet.BonusPage">
    
    <ContentPage.Content>
        
        <Grid RowDefinitions="70,*" RowSpacing="0">
            
            <controls:CustomNavigationbar
                Grid.Row="0"
                Padding="15,0,0,0"
                Title="{xct:Translate Cancel}"
                HeightImage="18"
                FontSize="{DynamicResource TSize_i7}"
                LeftButtonCommand="{prism:GoBack}" />

            <BoxView Grid.Row="0" HeightRequest="3" VerticalOptions="End" Color="{DynamicResource TextAndBackgroundColor_i6}"/>
            
            <Grid 
                Grid.Row="1"
                ColumnDefinitions="0.66*,0.34*" 
                ColumnSpacing="0" 
                VerticalOptions="FillAndExpand">

                <StackLayout>
                    <Label
                        Text="{xct:Translate OrderTabs}"
                        Grid.Column="0"
                        Margin="30,20,0,10"
                        TextColor="{DynamicResource TextAndBackgroundColor_i1}"
                        FontFamily="Barlow-Bold"
                        FontSize="{DynamicResource TSize_i4}" />

                    <BoxView 
                        HeightRequest="2" 
                        Color="{DynamicResource TextAndBackgroundColor_i3}"/>
                    
                </StackLayout>


                <StackLayout>
                    <StackLayout
                        VerticalOptions="FillAndExpand"
                        HorizontalOptions="FillAndExpand">
                        
                        <Grid VerticalOptions="FillAndExpand">
                            
                            <ffimageloading:CachedImage
                            Source="pic_coupon" 
                                VerticalOptions="CenterAndExpand"
                            HeightRequest="250"/>
                            
                            <Label 
                                Text="{xct:Translate SelectCoupon}"
                                TextColor="{DynamicResource TextAndBackgroundColor_i1}"
                                FontSize="{DynamicResource TSize_i6}"
                                FontFamily="Barlow-Regular"
                                Margin="0,300,0,0"
                                HorizontalOptions="Center"
                                VerticalOptions="Center"/>
                            
                        </Grid>
                        
                    </StackLayout>

                    <BoxView 
                        HeightRequest="2"
                        Color="{DynamicResource TextAndBackgroundColor_i3}"/>
                    
                    <buttons:BorderButton
                        HorizontalOptions="FillAndExpand"
                        Margin="40,15,40,15"
                        HeightRequest="35"
                        Text="{xct:Translate Apply}"
                        FontSize="{DynamicResource TSize_i6}"
                        TextColor="{DynamicResource TextAndBackgroundColor_i1}"
                        BorderColor="Transparent"
                        Opacity="0.3"
                        BackgroundColor="{DynamicResource AppColor_i1}"
                        Style="{DynamicResource BorderButtonStyle_i1}"
                        Command="{Binding BonusCommand}" />
                    
                </StackLayout>

                <BoxView Grid.Column="1"
                    BackgroundColor="{DynamicResource TextAndBackgroundColor_i4}"/>

                <ScrollView Grid.Column="1" >
                    <Grid 
                             Margin="20,25,20,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="30"/>
                            <RowDefinition Height="{Binding HeightCoupons}" />
                        <RowDefinition Height="30" />
                            <RowDefinition Height="{Binding HeightDiscounts}" />
                    </Grid.RowDefinitions>

                    
                        <Label 
                        Grid.Row="0"
                        Text="{xct:Translate Coupons}"
                        TextColor="{DynamicResource TextAndBackgroundColor_i1}" />

                    <CollectionView Grid.Row="1"
                            ItemsSource="{Binding Bonuses}"
                            SelectedItem="{Binding SelectedBonus}">

                        <CollectionView.ItemTemplate>

                            <DataTemplate x:DataType="models:BonusBindableModel">

                                <StackLayout
                                        HorizontalOptions="Fill"
                                    VerticalOptions="Start"
                                    Margin="0,10,0,0">

                                    <VisualStateManager.VisualStateGroups>

                                        <VisualStateGroup Name="CommonStates">

                                            <VisualState
                                                    Name="Normal">
                                                <VisualState.Setters>
                                                    <Setter
                                                            Property="BackgroundColor"
                                                            Value="{DynamicResource TextAndBackgroundColor_i4}" />
                                                </VisualState.Setters>
                                            </VisualState>

                                            <VisualState Name="Selected">
                                                <VisualState.Setters>
                                                    <Setter
                                                            Property="BackgroundColor"
                                                            Value="{DynamicResource AppColor_i4}" />
                                                    <Setter
                                                            TargetName="orderStatusLabel"
                                                            Property="Label.TextColor"
                                                            Value="{DynamicResource TextAndBackgroundColor_i1}" />
                                                    <Setter
                                                            TargetName="checkBoxImage"
                                                            Property="ffimageloading:CachedImage.Source"
                                                            Value="ic_check_box_checked_white" />
                                                </VisualState.Setters>
                                            </VisualState>

                                        </VisualStateGroup>

                                    </VisualStateManager.VisualStateGroups>

                                    <Frame BackgroundColor="Transparent"
                                           BorderColor="{DynamicResource TextAndBackgroundColor_i2}"
                                           CornerRadius="8"
                                           HeightRequest="50">
                                        
                                    <Grid
                                            Grid.Row="0"
                                            ColumnDefinitions="*,50">

                                        <ffimageloading:CachedImage
                                                Source="ic_check_box_unchecked_white"
                                                Grid.Column="1"
                                                HeightRequest="25"
                                                HorizontalOptions="CenterAndExpand"
                                                Margin="0,0,15,0"
                                                VerticalOptions="CenterAndExpand"
                                                x:Name="checkBoxImage">
                                        </ffimageloading:CachedImage>

                                        <Label
                                                Grid.Column="0"
                                                HorizontalOptions="FillAndExpand"
                                                Margin="20,13,0,0"
                                                Text="{Binding Name}"
                                                HeightRequest="{DynamicResource TSize_i9}"
                                                LineBreakMode="TailTruncation"
                                                TextColor="{DynamicResource TextAndBackgroundColor_i1}"
                                                FontSize="{DynamicResource TSize_i7}"
                                                FontFamily="Barlow-SemiBold" />

                                    </Grid>
                                        
                                    </Frame>

                                </StackLayout>

                            </DataTemplate>

                        </CollectionView.ItemTemplate>

                    </CollectionView>

                    <Label 
                        Grid.Row="2"
                        Text="{xct:Translate Discounts}"
                        TextColor="{DynamicResource TextAndBackgroundColor_i1}" />

                    <CollectionView Grid.Row="3"
                            ItemsSource="{Binding Bonuses}"
                            SelectedItem="{Binding SelectedBonus}">

                        <CollectionView.ItemTemplate>

                            <DataTemplate x:DataType="models:BonusBindableModel">

                                <StackLayout
                                        HorizontalOptions="Fill"
                                    VerticalOptions="Start"
                                    Margin="0,10,0,0">

                                    <VisualStateManager.VisualStateGroups>

                                        <VisualStateGroup Name="CommonStates">

                                            <VisualState
                                                    Name="Normal">
                                                
                                                <VisualState.Setters>
                                                    <Setter
                                                            Property="BackgroundColor"
                                                            Value="{DynamicResource TextAndBackgroundColor_i4}" />
                                                </VisualState.Setters>
                                                
                                            </VisualState>

                                            <VisualState Name="Selected">
                                                
                                                <VisualState.Setters>
                                                    <Setter
                                                            Property="BackgroundColor"
                                                            Value="{DynamicResource AppColor_i4}" />
                                                    <Setter
                                                            TargetName="orderStatusLabel"
                                                            Property="Label.TextColor"
                                                            Value="{DynamicResource TextAndBackgroundColor_i1}" />
                                                    <Setter
                                                            TargetName="checkBoxImage"
                                                            Property="ffimageloading:CachedImage.Source"
                                                            Value="ic_check_box_checked_white" />
                                                </VisualState.Setters>
                                                
                                            </VisualState>

                                        </VisualStateGroup>

                                    </VisualStateManager.VisualStateGroups>

                                    <Frame BackgroundColor="Transparent"
                                           BorderColor="{DynamicResource TextAndBackgroundColor_i2}"
                                           CornerRadius="8"
                                           HeightRequest="50">

                                        <Grid
                                            Grid.Row="0"
                                            ColumnDefinitions="*,50">

                                            <ffimageloading:CachedImage
                                                Source="ic_check_box_unchecked_white"
                                                Grid.Column="1"
                                                HeightRequest="25"
                                                HorizontalOptions="CenterAndExpand"
                                                Margin="0,0,15,0"
                                                VerticalOptions="CenterAndExpand"
                                                x:Name="checkBoxImage">
                                            </ffimageloading:CachedImage>

                                            <Label
                                                Grid.Column="0"
                                                HorizontalOptions="FillAndExpand"
                                                Margin="20,13,0,0"
                                                Text="{Binding Name}"
                                                HeightRequest="{DynamicResource TSize_i9}"
                                                LineBreakMode="TailTruncation"
                                                TextColor="{DynamicResource TextAndBackgroundColor_i1}"
                                                FontSize="{DynamicResource TSize_i7}"
                                                FontFamily="Barlow-SemiBold" />

                                        </Grid>

                                    </Frame>

                                </StackLayout>

                            </DataTemplate>

                        </CollectionView.ItemTemplate>

                    </CollectionView>

                </Grid>
                    
                </ScrollView>
                
            </Grid>

        </Grid>
        
    </ContentPage.Content>
    
</views:BaseContentPage>