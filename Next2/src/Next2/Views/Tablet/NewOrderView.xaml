<?xml version="1.0" encoding="UTF-8" ?>
<ContentView
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:xct="http://xamarin.com/schemas/2020/toolkit"
    xmlns:ffimageloading="clr-namespace:FFImageLoading.Forms;assembly=FFImageLoading.Forms"
    xmlns:local="clr-namespace:Next2"
    xmlns:controls="clr-namespace:Next2.Controls"
    xmlns:buttons="clr-namespace:Next2.Controls.Buttons"
    xmlns:templates="clr-namespace:Next2.Controls.Templates"
    xmlns:effects="clr-namespace:Next2.Effects"
    xmlns:models="clr-namespace:Next2.Models"
    xmlns:viewModels="clr-namespace:Next2.ViewModels.Tablet"
    x:Class="Next2.Views.Tablet.NewOrderView"
    x:DataType="viewModels:NewOrderViewModel">

    <ContentView.Resources>
        <ResourceDictionary>

            <Style x:Key="labeltSize_i4" TargetType="Label">

                <Setter Property="VisualStateManager.VisualStateGroups">

                    <VisualStateGroupList>
                        <VisualStateGroup Name="AdaptiveLabel">

                            <VisualState Name="default">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowWidth="0" MinWindowHeight="0" />
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="FontSize" Value="{DynamicResource TSize_i5}" />
                                </VisualState.Setters>

                            </VisualState>

                            <VisualState Name="moreiPadMini">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowWidth="1025" MinWindowHeight="601" />
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="FontSize" Value="{DynamicResource TSize_i4}" />
                                </VisualState.Setters>

                            </VisualState>

                        </VisualStateGroup>
                    </VisualStateGroupList>

                </Setter>

            </Style>

            <Style x:Key="labeltSize_i6" TargetType="Label">

                <Setter Property="VisualStateManager.VisualStateGroups">

                    <VisualStateGroupList>
                        <VisualStateGroup Name="AdaptiveLabel">

                            <VisualState Name="default">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowWidth="0" MinWindowHeight="0" />
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="FontSize" Value="{DynamicResource TSize_i7}" />
                                </VisualState.Setters>

                            </VisualState>

                            <VisualState Name="moreiPadMini">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowWidth="1025" MinWindowHeight="601" />
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="FontSize" Value="{DynamicResource TSize_i6}" />
                                </VisualState.Setters>

                            </VisualState>

                        </VisualStateGroup>
                    </VisualStateGroupList>

                </Setter>

            </Style>

        </ResourceDictionary>
    </ContentView.Resources>
    
    <Grid
        ColumnSpacing="0"
        ColumnDefinitions="*, 375">

        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup Name="AdaptiveRightPart">

                <VisualState Name="moreiPadPro11">

                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1195" />
                    </VisualState.StateTriggers>

                    <VisualState.Setters>
                        <Setter Property="ColumnDefinitions" Value="*, 484" />
                    </VisualState.Setters>

                </VisualState>

            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>

        <!--Left Part-->
        
        <StackLayout
            Grid.Row="0"
            Grid.Column="0"
            BackgroundColor="{DynamicResource TextAndBackgroundColor_i6}">

            <!--Header-->

            <StackLayout
                VerticalOptions="Start"
                Orientation="Horizontal"
                Padding="12, 11, 12, 0">

                <VisualStateManager.VisualStateGroups>
                    <VisualStateGroupList>
                        <VisualStateGroup Name="AdaptiveStackLayoutPadding">

                            <VisualState Name="miniPadding">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowHeight="601"/>
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="Padding" Value="24, 22, 24, 0" />
                                </VisualState.Setters>

                            </VisualState>

                            <VisualState Name="moreiPadMiniPadding">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowWidth="1134" MinWindowHeight="601"/>
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="Padding" Value="40, 34, 40, 0" />
                                </VisualState.Setters>

                            </VisualState>

                        </VisualStateGroup>
                    </VisualStateGroupList>
                </VisualStateManager.VisualStateGroups>

                <Label
                    Text="{xct:Translate NewOrder}"
                    TextColor="{DynamicResource TextAndBackgroundColor_i1}"
                    FontSize="{DynamicResource TSize_i4}"
                    FontFamily="Barlow-SemiBold">

                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup Name="AdaptiveLabel">

                            <VisualState Name="moreiPadMini">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowWidth="1025" MinWindowHeight="601" />
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="FontSize" Value="{DynamicResource TSize_i3}" />
                                    <Setter Property="FontFamily" Value="Barlow-Bold" />
                                </VisualState.Setters>

                            </VisualState>

                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>

                </Label>

                <ffimageloading:CachedImage
                    Source="ic_time_circle_24x24"
                    HorizontalOptions="EndAndExpand"/>

                <Label
                    Text="9:32:45 PM"
                    TextColor="{DynamicResource TextAndBackgroundColor_i1}"
                    VerticalTextAlignment="Center"
                    Style="{StaticResource labeltSize_i6}"
                    FontFamily="Barlow-Medium"
                    Margin="5, 0, 0, 0"/>

                <ffimageloading:CachedImage
                    Source="ic_calendar_24x24"
                    Margin="20, 0, 0, 0"/>

                <Label
                    Text="Tuesday, 21 March 2021"
                    TextColor="{DynamicResource TextAndBackgroundColor_i1}"
                    VerticalTextAlignment="Center"
                    Style="{StaticResource labeltSize_i6}"
                    FontFamily="Barlow-Medium"
                    Margin="5, 0, 0, 0"/>

            </StackLayout>

            <BoxView
                Margin="0, 12, 0, 0"
                HeightRequest="1"
                BackgroundColor="{DynamicResource TextAndBackgroundColor_i2}">

                <VisualStateManager.VisualStateGroups>
                    <VisualStateGroup Name="AdaptiveBoxView">

                        <VisualState Name="minHeight">

                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowHeight="601" />
                            </VisualState.StateTriggers>

                            <VisualState.Setters>
                                <Setter Property="Margin" Value="0, 22, 0, 0" />
                            </VisualState.Setters>

                        </VisualState>

                    </VisualStateGroup>
                </VisualStateManager.VisualStateGroups>
                
            </BoxView>

            <StackLayout VerticalOptions="Start">

                <!--Categories header-->
                
                <StackLayout
                    VerticalOptions="Start"
                    Orientation="Horizontal"
                    Padding="12, 11, 12, 0">

                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroupList>
                            <VisualStateGroup Name="AdaptiveStackLayoutPadding">

                                <VisualState Name="miniPadding">

                                    <VisualState.StateTriggers>
                                        <AdaptiveTrigger MinWindowHeight="601"/>
                                    </VisualState.StateTriggers>

                                    <VisualState.Setters>
                                        <Setter Property="Padding" Value="24, 22, 24, 0" />
                                    </VisualState.Setters>

                                </VisualState>

                                <VisualState Name="moreiPadMiniPadding">

                                    <VisualState.StateTriggers>
                                        <AdaptiveTrigger MinWindowWidth="1134" MinWindowHeight="601"/>
                                    </VisualState.StateTriggers>

                                    <VisualState.Setters>
                                        <Setter Property="Padding" Value="40, 34, 40, 0" />
                                    </VisualState.Setters>

                                </VisualState>

                            </VisualStateGroup>
                        </VisualStateGroupList>
                    </VisualStateManager.VisualStateGroups>

                    <Label
                        Text="{xct:Translate Categories}"
                        TextColor="{DynamicResource TextAndBackgroundColor_i1}"
                        Style="{StaticResource labeltSize_i4}"
                        FontFamily="Barlow-SemiBold"
                        VerticalTextAlignment="Center"/>

                    <Frame
                        HasShadow="False"
                        CornerRadius="5"
                        BorderColor="{DynamicResource TextAndBackgroundColor_i2}"
                        BackgroundColor="{DynamicResource TextAndBackgroundColor_i6}"
                        Padding="15, 5"
                        HorizontalOptions="EndAndExpand">

                        <StackLayout Orientation="Horizontal">

                            <ffimageloading:CachedImage Source="ic_category_24x24"/>

                            <Label
                                Text="{xct:Translate Expand}"
                                TextColor="{DynamicResource TextAndBackgroundColor_i1}"
                                FontSize="{DynamicResource TSize_i7}"
                                FontFamily="Barlow-Medium"
                                Margin="10, 0, 0, 0"/>

                        </StackLayout>

                    </Frame>

                </StackLayout>

                <controls:StepperCarousel
                    HeightRequest="100"
                    Margin="12, 10, 12, 16"
                    ItemsSource="{Binding CategoriesItems}"
                    SelectedItem="{Binding SelectedCategoriesItem}">

                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup Name="AdaptiveStepperCarousel">

                            <VisualState Name="minHeight">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowHeight="601" />
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="Margin" Value="24, 26, 24, 32" />
                                    <Setter Property="HeightRequest" Value="116" />
                                </VisualState.Setters>

                            </VisualState>

                            <VisualState Name="moreiPadMini">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowWidth="1134" MinWindowHeight="601" />
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="Margin" Value="40, 26, 40, 32" />
                                    <Setter Property="HeightRequest" Value="116" />
                                </VisualState.Setters>

                            </VisualState>

                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>

                </controls:StepperCarousel>

                <BoxView
                    HeightRequest="1"
                    Margin="12, 0"
                    BackgroundColor="{DynamicResource TextAndBackgroundColor_i2}">

                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup Name="AdaptiveBoxViewMargin">

                            <VisualState Name="miniMargin">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowHeight="601"/>
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="Margin" Value="24, 0" />
                                </VisualState.Setters>

                            </VisualState>

                            <VisualState Name="moreiPadMiniMargin">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowWidth="1134" MinWindowHeight="601"/>
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="Margin" Value="40, 0" />
                                </VisualState.Setters>

                            </VisualState>

                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>
                    
                </BoxView>

            </StackLayout>

            <!--Menu header-->
            
            <StackLayout
                VerticalOptions="Start"
                Orientation="Horizontal"
                Padding="12, 11, 12, 0">

                <VisualStateManager.VisualStateGroups>
                    <VisualStateGroupList>
                        <VisualStateGroup Name="AdaptiveStackLayoutPadding">

                            <VisualState Name="miniPadding">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowHeight="601"/>
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="Padding" Value="24, 22, 24, 0" />
                                </VisualState.Setters>

                            </VisualState>

                            <VisualState Name="moreiPadMiniPadding">

                                <VisualState.StateTriggers>
                                    <AdaptiveTrigger MinWindowWidth="1134" MinWindowHeight="601"/>
                                </VisualState.StateTriggers>

                                <VisualState.Setters>
                                    <Setter Property="Padding" Value="40, 34, 40, 0" />
                                </VisualState.Setters>

                            </VisualState>

                        </VisualStateGroup>
                    </VisualStateGroupList>
                </VisualStateManager.VisualStateGroups>

                <Label
                    Text="{xct:Translate Menu}"
                    TextColor="{DynamicResource TextAndBackgroundColor_i1}"
                    Style="{StaticResource labeltSize_i4}"
                    FontFamily="Barlow-SemiBold"
                    VerticalTextAlignment="Center"/>

                <Frame
                    HasShadow="False"
                    CornerRadius="5"
                    BorderColor="{DynamicResource TextAndBackgroundColor_i2}"
                    BackgroundColor="{DynamicResource TextAndBackgroundColor_i6}"
                    Padding="15, 5"
                    HorizontalOptions="EndAndExpand"
                    xct:TouchEffect.Command="{Binding TapSortCommand}">

                    <StackLayout Orientation="Horizontal">

                        <ffimageloading:CachedImage Source="ic_swap_24x24"/>

                        <Label
                            Text="{xct:Translate TypeOrder}"
                            TextColor="{DynamicResource TextAndBackgroundColor_i1}"
                            FontSize="{DynamicResource TSize_i7}"
                            FontFamily="Barlow-Medium"
                            Margin="10, 0, 0, 0"/>

                    </StackLayout>

                </Frame>

            </StackLayout>

            <!--Menu-->

            <CollectionView
                x:Name="menuCollectionView"
                Margin="12, 8, 12, 0"
                VerticalOptions="StartAndExpand"
                ItemsSource="{Binding SetsItems}"
                VerticalScrollBarVisibility="Always"
                SelectionMode="Single">

                <CollectionView.ItemsLayout>
                    
                    <GridItemsLayout
                        Orientation="Vertical"
                        VerticalItemSpacing="5"
                        HorizontalItemSpacing="5"
                        Span="2"/>
                    
                </CollectionView.ItemsLayout>

                <VisualStateManager.VisualStateGroups>
                    <VisualStateGroup Name="AdaptiveColumn">

                        <VisualState Name="minHeight">

                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowHeight="601" />
                            </VisualState.StateTriggers>

                            <VisualState.Setters>
                                <Setter Property="Margin" Value="24, 16, 24, 0"/>
                            </VisualState.Setters>

                        </VisualState>

                        <VisualState Name="moreiPadMiniColumn">

                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowWidth="1134" MinWindowHeight="601" />
                            </VisualState.StateTriggers>

                            <VisualState.Setters>
                                <Setter Property="ItemsLayout">

                                    <GridItemsLayout
                                        Orientation="Vertical"
                                        VerticalItemSpacing="5"
                                        HorizontalItemSpacing="5"
                                        Span="3"/>

                                </Setter>

                                <Setter Property="Margin" Value="40, 26, 40, 0"/>

                            </VisualState.Setters>

                        </VisualState>

                    </VisualStateGroup>
                </VisualStateManager.VisualStateGroups>

                <CollectionView.Effects>
                    <effects:NoOverScrollEffect/>
                    <effects:ScrollBarColorEffect ScrollBarColor="{StaticResource AppColor_i1}"/>
                </CollectionView.Effects>

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <templates:SetItemTemplate
                            x:DataType="models:SetModel"
                            HeightRequest="327"
                            xct:TouchEffect.Command="{Binding TapSetCommand, Source={RelativeSource AncestorType={x:Type viewModels:NewOrderViewModel}}}"
                            xct:TouchEffect.CommandParameter="{Binding .}"/>

                    </DataTemplate>
                </CollectionView.ItemTemplate>
                
            </CollectionView>

            <!--Tabs Subcategories Menu-->

            <CollectionView
                HeightRequest="50"
                MinimumHeightRequest="50"
                VerticalOptions="End"
                ItemsSource="{Binding SubcategoriesItems}"
                SelectedItem="{Binding SelectedSubcategoriesItem}"
                VerticalScrollBarVisibility="Never"
                SelectionMode="Single">

                <VisualStateManager.VisualStateGroups>
                    <VisualStateGroup Name="AdaptiveSubcategoriesCollectionView">

                        <VisualState Name="minHeight">

                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowHeight="601" />
                            </VisualState.StateTriggers>

                            <VisualState.Setters>
                                <Setter Property="HeightRequest" Value="82" />
                                <Setter Property="MinimumHeightRequest" Value="82" />
                            </VisualState.Setters>

                        </VisualState>

                    </VisualStateGroup>
                </VisualStateManager.VisualStateGroups>

                <CollectionView.Effects>
                    <effects:NoOverScrollEffect/>
                </CollectionView.Effects>

                <CollectionView.ItemsLayout>

                    <GridItemsLayout
                        Orientation="Vertical"
                        Span="5"
                        VerticalItemSpacing="0"
                        HorizontalItemSpacing="0"/>

                </CollectionView.ItemsLayout>

                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:SubcategoryModel">

                        <templates:SubCategoryItemTemplate
                            HeightRequest="50"
                            MinimumHeightRequest="50"
                            Text="{Binding Title}"
                            FontSize="{DynamicResource TSize_i6}"
                            FontFamily="Barlow-Medium">

                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup Name="AdaptiveSubCategoryItemTemplate">

                                    <VisualState Name="minHeight">

                                        <VisualState.StateTriggers>
                                            <AdaptiveTrigger MinWindowHeight="601" />
                                        </VisualState.StateTriggers>

                                        <VisualState.Setters>
                                            <Setter Property="HeightRequest" Value="82" />
                                            <Setter Property="MinimumHeightRequest" Value="82" />
                                        </VisualState.Setters>

                                    </VisualState>

                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>

                        </templates:SubCategoryItemTemplate>

                    </DataTemplate>
                </CollectionView.ItemTemplate>

            </CollectionView>

        </StackLayout>

        <!-- Order Registration Block -->
        <Grid
            Grid.Row="0"
            Grid.Column="1"
            RowDefinitions="auto, auto, auto, auto, 65"
            BackgroundColor="{DynamicResource TextAndBackgroundColor_i3}"
            x:DataType="viewModels:NewOrderViewModel">

            <Grid.Resources>
                
                <x:Double x:Key="OpacityWhenDisabled">0.32</x:Double>
            
                <Style TargetType="Label">
                    <Setter Property="VerticalOptions" Value="Center"/>
                    <Setter Property="TextColor" Value="{DynamicResource TextAndBackgroundColor_i1}"/>
                </Style>

                 <Style TargetType="ffimageloading:CachedImage">
                    <Setter Property="VerticalOptions" Value="Center"/>
                </Style>
            
                <Style x:Key="ButtonStyle_i1" TargetType="buttons:BorderButton">
                    <Setter Property="BackgroundColor" Value="{DynamicResource TextAndBackgroundColor_i3}"/>
                    <Setter Property="CornerRadius" Value="4"/>
                    <Setter Property="FontSize" Value="{DynamicResource TSize_i6}"/>
                    <Setter Property="FontFamily" Value="Barlow-SemiBold"/>
                    <Setter Property="VerticalOptions" Value="Center"/>
                    <Setter Property="Padding" Value="8"/>
                </Style>

                <Style TargetType="buttons:IconBorderButton">
                    <Setter Property="IconWidth" Value="26"/>
                    <Setter Property="IconHeight" Value="26"/>
                    <Setter Property="CornerRadius" Value="3"/>
                    <Setter Property="Padding" Value="10"/>
                </Style>
            
                <Style x:Key="DropDownDataTemplateStyle" TargetType="StackLayout">
                
                    <Setter Property="BackgroundColor" Value="{DynamicResource TextAndBackgroundColor_i3}"/>
                    <Setter Property="VisualStateManager.VisualStateGroups">
                    
                        <VisualStateGroupList>
                                <VisualStateGroup Name="CommonStates">
                                    <VisualState  Name="Normal" />
                                    <VisualState  Name="Selected">
                                    
                                        <VisualState.Setters>              
                                            <Setter Property="BackgroundColor" Value="{DynamicResource AppColor_i4}" />
                                        </VisualState.Setters>
                                    
                                    </VisualState>
                                </VisualStateGroup>
                        </VisualStateGroupList>
                    
                    </Setter>
                
                </Style>
            
                <!-- Bold (700) 32px -->
                <Style x:Key="Bold32pxLabelStyle" TargetType="Label">
                    <Setter Property="FontFamily" Value="Barlow-Bold"/>
                    <Setter Property="FontSize" Value="{DynamicResource TSize_i6}"/>
                </Style>
                        
                <!-- SemiBold (600) 24px -->
                <Style x:Key="SemiBold32pxLabelStyle" TargetType="Label">
                    <Setter Property="FontFamily" Value="Barlow-SemiBold"/>
                    <Setter Property="FontSize" Value="{DynamicResource TSize_i6}"/>
                </Style>
            
                <!-- SemiBold (600) 24px -->
                <Style x:Key="SemiBold24pxLabelStyle" TargetType="Label">
                    <Setter Property="FontFamily" Value="Barlow-SemiBold"/>
                    <Setter Property="FontSize" Value="{DynamicResource TSize_i8}"/>
                </Style>
            
                <!-- Medium (500) 24px -->
                <Style x:Key="Medium24pxLabelStyle" TargetType="Label">
                    <Setter Property="FontFamily" Value="Barlow-Medium"/>
                    <Setter Property="FontSize" Value="{DynamicResource TSize_i8}"/>
                </Style>
            
                 <!-- Regular (400) 32px -->
                <Style x:Key="Regular32pxLabelStyle" TargetType="Label">
                    <Setter Property="FontFamily" Value="Barlow-Regular"/>
                    <Setter Property="FontSize" Value="{DynamicResource TSize_i6}"/>
                </Style>

                <!-- SEPARATORS -->
                <Style x:Key="SeparatorLightBoxViewStyle" TargetType="BoxView">
                    <Setter Property="Color" Value="{DynamicResource TextAndBackgroundColor_i2}"/>
                    <Setter Property="HeightRequest" Value="0.25"/>
                </Style>
            
                <Style x:Key="SeparatorDarkBoxViewStyle" TargetType="BoxView">
                    <Setter Property="Color" Value="{DynamicResource TextAndBackgroundColor_i6}"/>
                    <Setter Property="HeightRequest" Value="0.25"/>
                </Style>
                
            </Grid.Resources>

            <!-- HEADER, 1 ROW -->
            <StackLayout
                Grid.Row="0"
                Padding="17, 19, 17, 24"
                HorizontalOptions="Start"
                Orientation="Horizontal"
                Spacing="17">

                <Label
                    Style="{DynamicResource Bold32pxLabelStyle}"
                    Margin="0, 2, 0, 0">

                    <Label.FormattedText>
                        <FormattedString>
                            <Span
                                Text="{xct:Translate Order}" />
                            <Span
                                Text=" " />
                            <Span
                                Text="{xct:Translate NumberSign}" />
                            <Span
                                Text="{Binding OrderRegistrationViewModel.NewOrderId}" />
                        </FormattedString>
                    </Label.FormattedText>

                    <Label.GestureRecognizers>
                        <TapGestureRecognizer
                            Command="{Binding OrderRegistrationViewModel.PayCommand}" />
                    </Label.GestureRecognizers>

                </Label>

            </StackLayout>

            <controls:DropDownList
                x:Name="dropDownList"
                Grid.Row="0"
                HorizontalOptions="End"
                VerticalOptions="Start"
                Margin="17, 19"
                WidthRequest="135"
                ListRowHeight="46.25"
                HeaderText="{Binding OrderRegistrationViewModel.SelectedOrderType.OrderTypeValue}"
                SelectedItem="{Binding OrderRegistrationViewModel.SelectedOrderType}"
                ItemsSource="{Binding OrderRegistrationViewModel.OrderTypes}">

                <controls:DropDownList.DataTemplate>

                    <DataTemplate>

                        <StackLayout
                            Style="{DynamicResource DropDownDataTemplateStyle}">

                            <StackLayout
                                HeightRequest="30"
                                Padding="14, 8"
                                Orientation="Horizontal">

                                <Label
                                    x:DataType="models:OrderTypeBindableModel"
                                    HorizontalOptions="FillAndExpand"
                                    FontSize="16"
                                    Text="{Binding OrderTypeValue}" />

                            </StackLayout>

                            <BoxView
                                Style="{DynamicResource SeparatorDarkBoxViewStyle}" />

                        </StackLayout>

                    </DataTemplate>

                </controls:DropDownList.DataTemplate>

            </controls:DropDownList>

            <!-- HEADER, 2 ROW -->
            <StackLayout
                Grid.Row="1"
                VerticalOptions="FillAndExpand"
                HorizontalOptions="End"
                Padding="17, 13, 17, 18"
                Orientation="Horizontal"
                Spacing="13">

                <Label
                    Style="{DynamicResource SemiBold32pxLabelStyle}"
                    HorizontalOptions="EndAndExpand"
                    Text="{xct:Translate Seats}">

                    <Label.Triggers>
                        <DataTrigger
                            TargetType="Label"
                            Binding="{Binding OrderRegistrationViewModel.Tables.Count}"
                            Value="0">

                            <Setter
                                Property="Opacity"
                                Value="{DynamicResource OpacityWhenDisabled}" />

                        </DataTrigger>
                    </Label.Triggers>

                </Label>

                <controls:CustomStepper
                    Spacing="20"
                    MaxValue="{Binding OrderRegistrationViewModel.SelectedTable.NumberOfAvailableSeats}"
                    Value="{Binding OrderRegistrationViewModel.NumberOfSeats}">

                    <controls:CustomStepper.Triggers>

                        <DataTrigger
                            TargetType="controls:CustomStepper"
                            Binding="{Binding OrderRegistrationViewModel.Tables.Count}"
                            Value="0">

                            <Setter
                                Property="Opacity"
                                Value="{DynamicResource OpacityWhenDisabled}" />
                            <Setter
                                Property="IsEnabled"
                                Value="False" />

                        </DataTrigger>

                    </controls:CustomStepper.Triggers>

                </controls:CustomStepper>

            </StackLayout>

            <controls:DropDownList
                Grid.Row="1"
                HorizontalOptions="Start"
                VerticalOptions="Start"
                Margin="18, 9"
                WidthRequest="145"
                ListRowHeight="46.5"
                HeaderText="{Binding OrderRegistrationViewModel.SelectedTable.Id, StringFormat='Table {0}'}"
                SelectedItem="{Binding OrderRegistrationViewModel.SelectedTable}"
                ItemsSource="{Binding OrderRegistrationViewModel.Tables}">

                <controls:DropDownList.DataTemplate>

                    <DataTemplate>

                        <StackLayout
                            Style="{DynamicResource DropDownDataTemplateStyle}">

                            <StackLayout
                                HeightRequest="30"
                                Padding="8"
                                Orientation="Horizontal"
                                x:DataType="models:TableBindableModel">

                                <Label
                                    HorizontalOptions="FillAndExpand"
                                    FontSize="16"
                                    Text="{Binding Id, StringFormat='Table {0}'}" />

                            </StackLayout>

                            <BoxView
                                Style="{DynamicResource SeparatorDarkBoxViewStyle}" />

                        </StackLayout>

                    </DataTemplate>

                </controls:DropDownList.DataTemplate>

            </controls:DropDownList>

            <!-- MEALS LIST -->
            <controls:CustomScrollBarCollectionView
                Grid.Row="2"
                VerticalScrollBarVisibility="Always"
                ThumbWidth="6"
                ScrollBarCornerRadius="10"
                ScrollBarThumbColor="{StaticResource AppColor_i1}"
                ScrollBarTrackColor="{StaticResource TextAndBackgroundColor_i2}"
                Background="{DynamicResource TextAndBackgroundColor_i5}"
                SelectionMode="Single"
    
                BackgroundColor="{DynamicResource TextAndBackgroundColor_i4}"
                ItemsSource="{Binding OrderRegistrationViewModel.Tables}">

                <CollectionView.Effects>
                    <effects:NoOverScrollEffect />
                </CollectionView.Effects>
                
                <CollectionView.EmptyView>
                    <StackLayout Spacing="0">

                        <ffimageloading:CachedImage
                            VerticalOptions="CenterAndExpand"
                            HorizontalOptions="Center"
                            Source="pic_payment.png" />

                        <Label
                            HorizontalOptions="Center"
                            HorizontalTextAlignment="Center"
                            VerticalOptions="StartAndExpand"
                            WidthRequest="160"
                            Text="{xct:Translate ToCreateNewOrderSelectDishCard}" />


                    </StackLayout>
                </CollectionView.EmptyView>
                
                <controls:CustomScrollBarCollectionView.ItemTemplate>
                    
                    <DataTemplate>
                        
                        <StackLayout Padding="30">
                            
                            <Label Text="A"/>
                            
                        </StackLayout>
                        
                    </DataTemplate>
                    
                </controls:CustomScrollBarCollectionView.ItemTemplate>
                
            </controls:CustomScrollBarCollectionView>

            <!-- SUMMARY -->
            <StackLayout
                Grid.Row="3">

                <StackLayout.Triggers>

                    <DataTrigger
                        TargetType="StackLayout"
                        Binding="{Binding OrderRegistrationViewModel.Tables.Count}"
                        Value="0">

                        <Setter
                            Property="IsVisible"
                            Value="false" />

                    </DataTrigger>

                </StackLayout.Triggers>

                <!-- SUMMARY HEADER -->
                <StackLayout
                    Padding="17, 11"
                    Spacing="13"
                    Orientation="Horizontal">

                    <Label
                        Style="{DynamicResource Bold32pxLabelStyle}"
                        Text="{xct:Translate Summary}" />

                    <buttons:IconBorderButton
                        HorizontalOptions="EndAndExpand"
                        IconSource="ic_time_circle_40x40"
                        Command="{Binding OrderRegistrationViewModel.OpenHoldSelectionCommand}" />

                    <buttons:IconBorderButton
                        IconSource="ic_discount_48x48"
                        Command="{Binding OrderRegistrationViewModel.OpenDiscountSelectionCommand}" />

                    <buttons:IconBorderButton
                        IconSource="ic_tax"
                        Command="{Binding OrderRegistrationViewModel.RemoveTaxFromOrderCommand}">

                        <buttons:IconBorderButton.Triggers>

                            <DataTrigger
                                TargetType="buttons:IconBorderButton"
                                Binding="{Binding OrderRegistrationViewModel.IsOrderWithTax}"
                                Value="false">

                                <Setter
                                    Property="IsVisible"
                                    Value="false" />

                            </DataTrigger>

                        </buttons:IconBorderButton.Triggers>

                    </buttons:IconBorderButton>

                </StackLayout>

                <BoxView
                    Style="{DynamicResource SeparatorDarkBoxViewStyle}" />

                <!-- SUMMARY BODY -->
                <StackLayout
                    Padding="17, 12, 17, 0"
                    Spacing="10">

                    <StackLayout
                        Orientation="Horizontal">

                        <Label
                            Style="{DynamicResource SemiBold24pxLabelStyle}"
                            Text="{xct:Translate Subtotal}" />

                        <Label
                            Style="{DynamicResource SemiBold24pxLabelStyle}"
                            HorizontalOptions="EndAndExpand">

                            <Label.FormattedText>

                                <FormattedString>

                                    <Span
                                        Text="{xct:Translate CurrencySign}" />
                                    <Span
                                        Text=" " />
                                    <Span
                                        Text="{Binding OrderRegistrationViewModel.SubTotal, StringFormat={x:Static local:Constants.PRICE_FORMAT}}" />

                                </FormattedString>

                            </Label.FormattedText>

                        </Label>

                    </StackLayout>

                    <StackLayout
                        Orientation="Horizontal">

                        <Label
                            Style="{DynamicResource SemiBold24pxLabelStyle}"
                            Text="{xct:Translate Tax}" />

                        <Label
                            Style="{DynamicResource SemiBold24pxLabelStyle}"
                            HorizontalOptions="EndAndExpand">

                            <Label.FormattedText>

                                <FormattedString>

                                    <Span
                                        Text="{xct:Translate CurrencySign}" />
                                    <Span
                                        Text=" " />
                                    <Span
                                        Text="{Binding OrderRegistrationViewModel.Tax, StringFormat={x:Static local:Constants.PRICE_FORMAT}}" />

                                </FormattedString>

                            </Label.FormattedText>

                        </Label>

                    </StackLayout>

                    <BoxView
                        Style="{DynamicResource SeparatorLightBoxViewStyle}" />

                    <StackLayout
                        Orientation="Horizontal">

                        <Label
                            Style="{DynamicResource Regular32pxLabelStyle}"
                            Text="{xct:Translate Total}" />

                        <Label
                            Style="{DynamicResource Bold32pxLabelStyle}"
                            HorizontalOptions="EndAndExpand">

                            <Label.FormattedText>

                                <FormattedString>

                                    <Span
                                        Text="{xct:Translate CurrencySign}" />
                                    <Span
                                        Text=" " />
                                    <Span
                                        Text="{Binding OrderRegistrationViewModel.Total, StringFormat={x:Static local:Constants.PRICE_FORMAT}}" />

                                </FormattedString>

                            </Label.FormattedText>

                        </Label>

                    </StackLayout>

                </StackLayout>

            </StackLayout>

            <!-- BUTTONS -->
            <Grid
                Grid.Row="4"
                VerticalOptions="End"
                Padding="18, 12"
                RowDefinitions="auto"
                ColumnSpacing="10">

                <Grid.Triggers>

                    <DataTrigger
                        TargetType="Grid"
                        Binding="{Binding OrderRegistrationViewModel.Tables.Count}"
                        Value="0">

                        <Setter
                            Property="Opacity"
                            Value="{DynamicResource OpacityWhenDisabled}" />
                        <Setter
                            Property="IsEnabled"
                            Value="False" />

                    </DataTrigger>

                </Grid.Triggers>

                <buttons:BorderButton
                    Grid.Column="0"
                    Style="{DynamicResource ButtonStyle_i1}"
                    BorderColor="{DynamicResource IndicationColor_i5}"
                    Text="{xct:Translate Order}"
                    Command="{Binding OrderRegistrationViewModel.OrderCommand}" />

                <buttons:BorderButton
                    Grid.Column="1"
                    Style="{DynamicResource ButtonStyle_i1}"
                    BorderColor="{DynamicResource IndicationColor_i7}"
                    Text="{xct:Translate Tab}"
                    Command="{Binding OrderRegistrationViewModel.TabCommand}" />

                <buttons:BorderButton
                    Grid.Column="2"
                    Style="{DynamicResource ButtonStyle_i1}"
                    Background="{DynamicResource IndicationColor_i1}"
                    BorderColor="{DynamicResource IndicationColor_i1}"
                    TextColor="{DynamicResource TextAndBackgroundColor_i3}"
                    Text="{xct:Translate Pay}"
                    Command="{Binding OrderRegistrationViewModel.PayCommand}" />

            </Grid>

        </Grid>

    </Grid>

</ContentView>