<?xml version="1.0" encoding="UTF-8"?>
<Grid 
    xmlns="http://xamarin.com/schemas/2014/forms" 
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml" 
    xmlns:models="clr-namespace:Next2.Models"
    xmlns:templates="clr-namespace:Next2.Controls.Templates"
    x:Class="Next2.Controls.Templates.ProductItemTemplate"
    xmlns:xct="http://xamarin.com/schemas/2020/toolkit"
    RowDefinitions="auto, auto">

    <StackLayout
        Grid.Row="1" 
        BindableLayout.ItemsSource="{Binding Source={RelativeSource AncestorType={x:Type templates:ProductItemTemplate}}, Path=ItemsSource}">

        <BindableLayout.ItemTemplate>

            <DataTemplate x:DataType="models:ProductBindableModel">

                <StackLayout>

                    <BoxView 
                        BackgroundColor="{DynamicResource TextAndBackgroundColor_i3}"
                        HeightRequest="1"
                        VerticalOptions="Start"/>

                    <Label
                        Text="{Binding SelectedProduct.Title, StringFormat='{0}:'}"
                        TextColor="{DynamicResource AppColor_i1}"
                        FontSize="{DynamicResource TSize_i5}"
                        Margin="0, 10, 0, 0"/>

                    <Label 
                        Margin="0, 10, 0, 0"
                        VerticalOptions="Start"
                        Text="{xct:Translate Inventory}"
                        FontFamily="Barlow-SemiBold"
                        FontSize="{DynamicResource TSize_i6}"
                        TextColor="{DynamicResource TextAndBackgroundColor_i9}"/>

                    <StackLayout
                        BindableLayout.ItemsSource="{Binding DetailedSelectedIngredientModels}"
                        Margin="0, 0, 0, 10">

                        <BindableLayout.ItemTemplate>
                            <DataTemplate x:DataType="models:IngredientBindableModel">
                                <Grid 
                                    Grid.Row="1"
                                    ColumnDefinitions="0.50*, 0.50*"
                                    RowDefinitions="auto, auto">

                                    <StackLayout 
                                        Grid.Column="0"
                                        Grid.Row="1"
                                        VerticalOptions="Start"
                                        Orientation="Vertical">

                                        <Label 
                                            Text="{Binding Title}"
                                            Margin="0, 5, 0, 0"
                                            FontFamily="Barlow-Medium"
                                            FontSize="{DynamicResource TSize_i5}"
                                            TextColor="{DynamicResource TextAndBackgroundColor_i1}"/>

                                    </StackLayout>

                                    <StackLayout 
                                        Grid.Column="1"
                                        Grid.Row="1"
                                        HorizontalOptions="EndAndExpand"
                                        Orientation="Vertical">

                                        <Label 
                                            Text="{Binding Price, StringFormat='$ {0:F2}'}"
                                            Margin="0, 5, 0, 0"
                                            FontFamily="Barlow-SemiBold"
                                            FontSize="{DynamicResource TSize_i5}"
                                            TextColor="{DynamicResource IndicationColor_i1}">
                                            
                                            <Label.Triggers>
                                                <MultiTrigger TargetType="Label">
                                                    
                                                    <MultiTrigger.Conditions>

                                                        <BindingCondition Binding="{Binding IsDefault}" Value="True"/>
                                                        <BindingCondition Binding="{Binding IsToggled}" Value="False"/>

                                                    </MultiTrigger.Conditions>
                                                    
                                                    <Setter Property="TextColor" Value="{DynamicResource IndicationColor_i3}"/>
                                                    <Setter Property="FormattedText" Value="$ 0.00"/>
                                                    
                                                </MultiTrigger>
                                            </Label.Triggers>

                                        </Label>

                                    </StackLayout>

                                </Grid>
                                
                            </DataTemplate>
                            
                        </BindableLayout.ItemTemplate>

                    </StackLayout>

                    <BoxView 
                        BackgroundColor="{DynamicResource TextAndBackgroundColor_i3}"
                        HeightRequest="1"
                        VerticalOptions="Start"/>

                    <Label 
                        Margin="0, 10, 0, 0"
                        VerticalOptions="Start"
                        Text="{xct:Translate Replace}"
                        FontFamily="Barlow-SemiBold"
                        FontSize="{DynamicResource TSize_i6}"
                        TextColor="{DynamicResource TextAndBackgroundColor_i9}"/>

                    <Grid Margin="0, 0, 0, 10" 
                        Grid.Row="1"
                        ColumnDefinitions="0.50*, 0.50*"
                        RowDefinitions="auto, auto">

                        <StackLayout 
                            Grid.Column="0"
                            Grid.Row="1"
                            VerticalOptions="Start"
                            Orientation="Vertical">

                            <Label 
                                Text="{Binding SelectedProduct.Title}"
                                Margin="0, 5, 0, 0"
                                FontFamily="Barlow-Medium"
                                FontSize="{DynamicResource TSize_i5}"
                                TextColor="{DynamicResource TextAndBackgroundColor_i1}"/>

                        </StackLayout>

                        <StackLayout 
                            Grid.Column="1"
                            Grid.Row="1"
                            HorizontalOptions="EndAndExpand"
                            Orientation="Vertical">

                            <Label 
                                Text="{Binding SelectedProduct.ProductPrice, StringFormat='$ {0:F2}'}"
                                Margin="0, 5, 0, 0"
                                FontFamily="Barlow-SemiBold"
                                FontSize="{DynamicResource TSize_i5}"
                                TextColor="{DynamicResource IndicationColor_i1}"/>

                        </StackLayout>

                    </Grid>

                    <StackLayout>

                        <BoxView 
                            BackgroundColor="{DynamicResource TextAndBackgroundColor_i3}"
                            HeightRequest="1"
                            VerticalOptions="Start"/>

                        <Label 
                            Margin="0, 10, 0, 0"
                            VerticalOptions="Start"
                            Text="{xct:Translate Option}"
                            FontFamily="Barlow-SemiBold"
                            FontSize="{DynamicResource TSize_i6}"
                            TextColor="{DynamicResource TextAndBackgroundColor_i9}"/>

                        <Label 
                            Text="{Binding SelectedOption.Title}"
                            Margin="0, 5, 0, 10"
                            FontFamily="Barlow-Medium"
                            FontSize="{DynamicResource TSize_i5}"
                            TextColor="{DynamicResource TextAndBackgroundColor_i1}"/>

                    </StackLayout>

                </StackLayout>

            </DataTemplate>

        </BindableLayout.ItemTemplate>

    </StackLayout>

</Grid>